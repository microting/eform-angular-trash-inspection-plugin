<subheader-pn [title]="'Trash Inspections' | translate">
  <div class="p-3">
    <button
      id="createInstallationBtn"
      class="btn btn-success"
      mdbTooltip="{{ 'Create Trash Inspection' | translate }}"
      (click)="showCreateTrashInspection()">{{ 'New Trash Inspection' | translate }}
    </button>
  </div>
</subheader-pn>

<div class="container-fluid">
  <div class="row p-1 mt-4 table-responsive no-gutters">
    <table class="table table-sm table-striped text-center z-depth-1">
      <thead>
      <tr>
        <th scope="col" class="table-header-sortable" id="idTableHeader"
            (click)="sortTable('Id')">
          <div class="d-flex align-items-center justify-content-center">
            ID
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Id'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Id' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Id' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="dateTableHeader"
            (click)="sortTable('Date')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Date' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Date'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Date' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Date' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="timeTableHeader"
            (click)="sortTable('Time')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Time' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Time'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Time' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Time' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="eakCodeTableHeader"
            (click)="sortTable('eakCode')">
          <div class="d-flex align-items-center justify-content-center">
            {{'eakCode' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'eakCode'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'eakCode' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'eakCode' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="installationTableHeader"
            (click)="sortTable('InstallationId')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Installation' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Installation'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Installation' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Installation' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="segmentTableHeader"
            (click)="sortTable('SegmentId')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Segment' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Segment'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Segment' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Segment' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="mustBeInspectedTableHeader"
            (click)="sortTable('MustBeInspected')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Must Be Inspected' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'MustBeInspected'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'MustBeInspected' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'MustBeInspected' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="producerTableHeader"
            (click)="sortTable('Producer')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Producer' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Producer'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Producer' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Producer' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="registrationNumberTableHeader"
            (click)="sortTable('RegistrationNumber')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Registration Number' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'RegistrationNumber'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'RegistrationNumber' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'RegistrationNumber' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="transporterTableHeader"
            (click)="sortTable('Transporter')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Transporter' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Transporter'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Transporter' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Transporter' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="trashFractionTableHeader"
            (click)="sortTable('TrashFraction')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Trash Fraction' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'TrashFraction'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'TrashFraction' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'TrashFraction' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="weighingNumberTableHeader"
            (click)="sortTable('WeighingNumber')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Weighing Number' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'WeighingNumber'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'WeighingNumber' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'WeighingNumber' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="isExtendedInspectionTableHeader"
            (click)="sortTable('IsExtendedInspection')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Extended inspection' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'IsExtendedInspection'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'IsExtendedInspection' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'IsExtendedInspection' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="isApprovedTableHeader"
            (click)="sortTable('IsApproved')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Is approved' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'IsApproved'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'IsApproved' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'IsApproved' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="commentTableHeader"
            (click)="sortTable('Comment')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Comment' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Comment'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Comment' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Comment' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="statusTableHeader"
            (click)="sortTable('Name')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Status' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'Status'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Status' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'Status' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col" class="table-header-sortable" id="isRemovedTableHeader"
            (click)="sortTable('IsRemoved')">
          <div class="d-flex align-items-center justify-content-center">
            {{'Is removed' | translate}}
            <i class="material-icons text-black-50" *ngIf="localPageSettings.sort != 'IsRemoved'">unfold_more</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'IsRemoved' && !trashInspectionsRequestModel.isSortDsc">expand_less</i>
            <i class="material-icons"
               *ngIf="localPageSettings.sort == 'IsRemoved' && trashInspectionsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>

        <th scope="col">
          {{ 'Actions' | translate }}
        </th>
      </tr>
      </thead>
      <tbody id="tableBody">
      <tr *ngFor="let trashInspection of trashInspectionsModel.trashInspectionList">
        <td>
          {{trashInspection.id}}
        </td>
        <td>
          <date-formatter [date]="trashInspection.date" [Format]="'date'"></date-formatter>
        </td>
        <td>
          <date-formatter [date]="trashInspection.time" [Format]="'time'"></date-formatter>
        </td>
        <td>
          {{trashInspection.eakCode}}
        </td>
        <td>
          {{trashInspection.installationName}}
        </td>
        <td>
          {{trashInspection.segment}}
        </td>
        <td>
          <fa-icon icon="check" size="lg" [fixedWidth]="true" *ngIf="trashInspection.mustBeInspected"></fa-icon>
        </td>
        <td>
          {{trashInspection.producer}}
        </td>
        <td>
          {{trashInspection.registrationNumber}}
        </td>
        <td>
          {{trashInspection.transporter}}
        </td>
        <td>
          {{trashInspection.trashFraction}}
        </td>
        <td>
          {{trashInspection.weighingNumber}}
        </td>
        <td>
          <fa-icon icon="check" size="lg" [fixedWidth]="true" *ngIf="trashInspection.extendedInspection"></fa-icon>

        </td>
        <td>

          <fa-icon icon="check" size="lg" [fixedWidth]="true" *ngIf="trashInspection.isApproved"></fa-icon>

          <fa-icon icon="times" size="lg" [fixedWidth]="true" *ngIf="!trashInspection.isApproved"></fa-icon>

        </td>
        <td>
          {{trashInspection.comment}}
        </td>
        <td>
          <status-bar [status]="trashInspection.status"></status-bar>
        </td>
        <td>

          <fa-icon icon="check" size="lg" [fixedWidth]="true" *ngIf="trashInspection.workflowState == 'removed' || trashInspection.inspectionDone"></fa-icon>

<!--          <fa-icon icon="times" size="lg" [fixedWidth]="true" *ngIf="trashInspection.isApproved == 'removed'"></fa-icon>-->

        </td>
        <td>
          <div class="d-flex flex-row justify-content-center">

            <button class="btn btn-danger btn-icon mb-2 "
                    mdbTooltip="{{ 'Delete Trash Inspection' | translate }}"
                    (click)="showDeleteTrashInspectionModal(trashInspection)">
              <fa-icon icon="trash-alt" size="lg" [fixedWidth]="true" ></fa-icon>
            </button>
            <button class="btn btn-success text-black-50 btn-icon mb-2"
                    mdbTooltip="{{ 'Get PDF' | translate }}"
                    (click)="downloadPDF(trashInspection)" *ngIf="trashInspection.status == 100">
              <fa-icon icon="file-pdf" size="lg" [fixedWidth]="true" ></fa-icon>

            </button>
            <button class="btn btn-success text-black-50 btn-icon mb-2"
                    mdbTooltip="{{ 'Get DOCX' | translate }}"
                    (click)="downloadDocx(trashInspection)" *ngIf="trashInspection.status == 100">
              <fa-icon icon="file-word" size="lg" [fixedWidth]="true"></fa-icon>

            </button>
            <button class="btn btn-success text-black-50 btn-icon mb-2"
                    mdbTooltip="{{ 'Analytics' | translate }}"
                    (click)="showVersionViewModal(trashInspection.id)">
              <fa-icon icon="chart-bar" size="lg" [fixedWidth]="true"></fa-icon>

            </button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="row justify-content-between mr-2 ml-2">
    <div class="col-md-1">
      <page-size-pn
        [pageSize]="localPageSettings.pageSize"
        (onPageSizeChanged)="localPageSettings.pageSize = $event; trashInspectionsRequestModel.pageIndex = 1;
        updateLocalPageSettings()">
      </page-size-pn>
    </div>
    <div class="col-md-4 ml-auto d-flex justify-content-end p-2">
      <pagination-pn *ngIf="trashInspectionsModel.total > trashInspectionsRequestModel.pageSize"
                     [limit]="trashInspectionsRequestModel.pageSize"
                     [size]="trashInspectionsModel.total"
                     [offset]="trashInspectionsRequestModel.offset"
                     (onPageChanged)="changePage($event)"></pagination-pn>
    </div>
  </div>
</div>

<spinner-pn [spinnerVisibility]="spinnerStatus"></spinner-pn>

<app-trash-inspection-pn-trash-inspection-create #createTrashInspectionModal
                                                 (onTrashInspectionCreated)="getAllTrashInspections()"></app-trash-inspection-pn-trash-inspection-create>
<app-trash-inspection-pn-trash-inspection-delete #deleteTrashInspectionModal
                                                 (onTrashInspectionDeleted)="getAllTrashInspections()"></app-trash-inspection-pn-trash-inspection-delete>
<app-trash-inspection-pn-trash-inspection-version-view #versionViewModal
></app-trash-inspection-pn-trash-inspection-version-view>
